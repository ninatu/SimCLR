batch_size: 256 #512
epochs: 80
eval_every_n_epochs: 1
log_every_n_steps: 50
weight_decay: 10e-6
fp16_precision: False

T_max_decrease: 10

#fine_tune_from: None
#epoch_warmup: 1

fine_tune_from: exp_1_mood
epoch_warmup: 0

model:
  out_dim: 256
  base_model: "vgg19"

dataset:
  dataset_type: MOOD
  dataset_params:
    s: 1
    input_shape: (96,96,3)
    num_workers: 16
    valid_size: 0.05
    train:
      - image_root: /gpfs/data/gpfs0/n.tuluptceva/data/mood/preprocessed/brain_train/2d_axis_0
        folds_path: /gpfs/data/gpfs0/n.tuluptceva/source/mood_anomaly_detection/folds/brain/train_folds_10.csv
        fold: 0
        split: train
        channels3: True
        return_image_name: True

      - image_root: /gpfs/data/gpfs0/n.tuluptceva/data/mood/preprocessed/brain_train/2d_axis_1
        folds_path: /gpfs/data/gpfs0/n.tuluptceva/source/mood_anomaly_detection/folds/brain/train_folds_10.csv
        fold: 0
        split: train
        channels3: True
        return_image_name: True
          
      - image_root: /gpfs/data/gpfs0/n.tuluptceva/data/mood/preprocessed/brain_train/2d_axis_2
        folds_path: /gpfs/data/gpfs0/n.tuluptceva/source/mood_anomaly_detection/folds/brain/train_folds_10.csv
        fold: 0
        split: train
        channels3: True
        return_image_name: True

      - image_root: /gpfs/data/gpfs0/n.tuluptceva/data/mood/preprocessed/abdom_train/2d_axis_0
        folds_path: /gpfs/data/gpfs0/n.tuluptceva/source/mood_anomaly_detection/folds/abdom/train_folds_10.csv
        fold: 0
        split: train
        channels3: True
        return_image_name: True

      - image_root: /gpfs/data/gpfs0/n.tuluptceva/data/mood/preprocessed/abdom_train/2d_axis_1
        folds_path: /gpfs/data/gpfs0/n.tuluptceva/source/mood_anomaly_detection/folds/abdom/train_folds_10.csv
        fold: 0
        split: train
        channels3: True
        return_image_name: True
          
      - image_root: /gpfs/data/gpfs0/n.tuluptceva/data/mood/preprocessed/abdom_train/2d_axis_2
        folds_path: /gpfs/data/gpfs0/n.tuluptceva/source/mood_anomaly_detection/folds/abdom/train_folds_10.csv
        fold: 0
        split: train
        channels3: True
        return_image_name: True
        
    val:
      - image_root: /gpfs/data/gpfs0/n.tuluptceva/data/mood/preprocessed/brain_train/2d_axis_0
        folds_path: /gpfs/data/gpfs0/n.tuluptceva/source/mood_anomaly_detection/folds/brain/train_folds_10.csv
        fold: 0
        split: val
        channels3: True
        return_image_name: True

      - image_root: /gpfs/data/gpfs0/n.tuluptceva/data/mood/preprocessed/brain_train/2d_axis_1
        folds_path: /gpfs/data/gpfs0/n.tuluptceva/source/mood_anomaly_detection/folds/brain/train_folds_10.csv
        fold: 0
        split: val
        channels3: True
        return_image_name: True

      - image_root: /gpfs/data/gpfs0/n.tuluptceva/data/mood/preprocessed/brain_train/2d_axis_2
        folds_path: /gpfs/data/gpfs0/n.tuluptceva/source/mood_anomaly_detection/folds/brain/train_folds_10.csv
        fold: 0
        split: val
        channels3: True
        return_image_name: True

      - image_root: /gpfs/data/gpfs0/n.tuluptceva/data/mood/preprocessed/abdom_train/2d_axis_0
        folds_path: /gpfs/data/gpfs0/n.tuluptceva/source/mood_anomaly_detection/folds/abdom/train_folds_10.csv
        fold: 0
        split: val
        channels3: True
        return_image_name: True

      - image_root: /gpfs/data/gpfs0/n.tuluptceva/data/mood/preprocessed/abdom_train/2d_axis_1
        folds_path: /gpfs/data/gpfs0/n.tuluptceva/source/mood_anomaly_detection/folds/abdom/train_folds_10.csv
        fold: 0
        split: val
        channels3: True
        return_image_name: True

      - image_root: /gpfs/data/gpfs0/n.tuluptceva/data/mood/preprocessed/abdom_train/2d_axis_2
        folds_path: /gpfs/data/gpfs0/n.tuluptceva/source/mood_anomaly_detection/folds/abdom/train_folds_10.csv
        fold: 0
        split: val
        channels3: True
        return_image_name: True

loss:
  temperature: 0.5
  use_cosine_similarity: True
